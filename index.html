<!DOCTYPE html>
<meta charset="UTF-8">
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="watch.js" type="text/javascript"></script>
    <!-- watch will be global variable -->
    <link rel="stylesheet" href="twittler.css">
    <link rel+"stylesheet" href="bootstrap.min.css">
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var time = new Date();

        var $body = $('body');
        //$body.html('');

        var $main = $('main'); 
        var $tweetspace = $('#tweetspace');
        //var $h2 = $('<h2></h2>');
        //$h2.text("Zach's Twittler").appendTo($body);
        
        //var time = new Date();
        var mycount = 0; 
        
        load();
        /* loads too many tweets too fast, not usable, switching to interval
        watch(streams, "home", function(){
          fetch();
        });
       */

       //setInterval(fetch, 3000);
       $button = $('button');
       $button.on("click", fetch);

        function fetch(){
          var index = streams.home.length - 1;
          var count = mycount;
          while(count <= index){
            var tweet = streams.home[mycount];
        

              var $tweet = $('<div></div>');
              $tweet.text('@' + tweet.user + ': ' + tweet.message + " posted at " +tweet.created_at.toLocaleTimeString());
              $tweet.addClass("tweet");

              $tweet.insertAfter($tweetspace);
             // index -= 1;
              mycount++;
              //time = tweet.created_at;
        
          }
        };

        function load(){
          var index = streams.home.length - 1;
          var $divspacer = $('<div></div>');
          $divspacer.addClass('col-md-4');
          while(mycount <= index){
            var tweet = streams.home[mycount];

              var $tweet = $('<div></div>');
              $tweet.text('@' + tweet.user + ': ' + tweet.message + " posted at " +tweet.created_at.toLocaleTimeString());
              $tweet.addClass("tweet");
              $tweet.addClass('col-md-8');
              $divspacer.insertAfter($divspacer);
              $tweet.insertAfter($tweetspace);
              index -= 1;
              mycount++;
          }
          
        };



      });

    </script>      

   
    <header class="clearfix">
      <h1>Twittler</h1>
      <nav>
        <ul>
          <li><a id="home" href="index.html">Home</a></li>
          <li><a id="user" href="index.html">Users</a></li>
          <li><a id="about" href="index.html">About</a></li>
        </ul>
      </nav>
    </header>
      <main>
        <div id="newtweet" class="col-md-4">
          <p>Submit a new tweet</p>
          <button type="button">Load tweets</button>
        </div>
        <div id="tweetspace" class="col-md-8">
        </div>
      </main>
    
    <footer>
      <p>&copy; 2014 Zachary Lopez for Hack Reactor</p>
    </footer>
    
    

  </body>
</html>
