<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="watch.js" type="text/javascript"></script>
    <!-- watch will be global variable -->
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var time = new Date();

        var $body = $('body');
        $body.html('');

        var $h2 = $('<h2></h2>');
        $h2.text("Zach's Twittler").appendTo($body);
        
        var time = new Date();
        var mycount = 0; 
        
        load();
        /* loads too many tweets too fast, not usable, switching to interval
        watch(streams, "home", function(){
          fetch();
        });
       */

       setInterval(fetch, 3000);

        function fetch(){
          var index = streams.home.length - 1;
          var count = mycount;
          while(count <= index){
            var tweet = streams.home[mycount];
        

              var $tweet = $('<div></div>');
              $tweet.text('@' + tweet.user + ': ' + tweet.message + " posted at " +tweet.created_at.toLocaleTimeString());
              $tweet.insertAfter($h2);
             // index -= 1;
              mycount++;
              //time = tweet.created_at;
        
          }
        };

        function load(){
          var index = streams.home.length - 1;
          while(mycount <= index){
            var tweet = streams.home[mycount];

              var $tweet = $('<div></div>');
              $tweet.text('@' + tweet.user + ': ' + tweet.message + " posted at " +tweet.created_at.toLocaleTimeString());
              $tweet.insertAfter($h2);
              index -= 1;
              mycount++;
          }
        };



      });

    </script>
  </body>
</html>
